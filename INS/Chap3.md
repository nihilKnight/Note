# Internet协议的安全性

## 网际层协议

1. IP协议：
    - 主要特点：（1）<u>无连接</u>；（2）<u>不可靠</u>；（3）<u>点对点协议</u>；（4）<u>效率高</u>；（5）<u>无状态</u>。
    - 主要功能：（1）分配IP地址；（2）<u>路由选择</u>；（3）<u>分组传输</u>；（4）<u>分片与重组</u>。

2. ICMP协议：控制报文协议是一个重要的错误处理和信息处理协议。
    - 安全问题：（1）ICMP重定向攻击；（2）ICMP路由器发现攻击；（3）防火墙穿越攻击。

3. IGMP协议：组管理协议是TCP/IP协议族中<u>负责IP组播成员管理</u>的协议。
    - 安全问题：（1）利用查询报文攻击；（2）利用离开报文进行DoS攻击；（3）利用报告报文进行攻击。
    - 防护措施：采用<u>公钥密码技术</u>实现组播组成员的身份认证。

4. OSPF协议：开放最短路径优先协议是一个内部网关协议，用于在单一自治系统内实施路由决策。

5. BGP协议：边界网关协议将<u>单一管理</u>的网络转化为由多个自治系统<u>分散互连的网络</u>。
    - 安全问题：缺乏安全可信的<u>路由认证机制</u>。
    - 防护措施：路由认证类方案（MD5 BGP认证技术、S-BGP方案、soBGP方案等）与前缀劫持检测类方案（多源AS检测技术、主动探测技术）。

## 传输层协议

1. TCP协议：传输控制协议是一种<u>面向连接的</u>、<u>可靠的</u>传输层通信协议。
    - 安全问题：<u>SYN Flood攻击</u>、<u>TCP会话劫持攻击</u>、<u>针对拥塞控制机制的攻击</u>。

2. UDP协议：用户数据报协议是一种<u>无连接的</u>传输层协议，提供面向事务的简单不可靠信息传送服务。
    - 特点：（1）无需连接、传输高效；（2）无拥塞控制的不可靠交付；（3）数据报首部仅8字节；（4）网络拥塞不会降低发送速率。
    - 安全问题：UDP Flood攻击。

## 应用层协议

1. RIP协议（<u>UDP 520</u>）：动态路由选择协议是一种动态内部路由/网关协议，用于自治系统内的路由信息传递。
    - 安全问题：<u>RIP 欺骗攻击</u>。
    - 防护措施：（1）将路由器的某些接口配置为被动接口；（2）配置路由器访问控制列表。

2. HTTP协议（<u>TCP 80</u>）：超文本传输协议是一个<u>客户端</u>和<u>服务器端</u>请求和应答的标准，是互联网上应用最广泛的一种网络协议。
    - 安全问题：<u>嗅探攻击</u>、<u>中间人攻击</u>。
    - 防护措施：在HTTP和TCP协议间增加<u>安全套接层</u>来增加安全性，即采用SSL协议（<u>TCP 443</u>）传输数据。

3. TELNET协议（<u>TCP 23</u>）：远程登陆协议是Internet远程登陆服务的标准协议和主要方法。
    - 安全问题：<u>嗅探攻击</u>、<u>Telnet会话劫持攻击</u>。

4. SSH协议（<u>TCP 22</u>）：安全壳协议是一种在不安全网络上建立安全远程登陆或其他安全网络服务的协议。
    - 安全问题：<u>无服务器认证</u>、<u>不检测协议版本</u>、<u>主机密钥存储不安全</u>。

5. DNS协议（<u>UDP 53</u>）：域名系统协议用于实现域名与IP地址之间的映射。
    - 安全问题：<u>DNS欺骗攻击</u>、<u>DNS缓存中毒攻击</u>、<u>DNS重定向攻击</u>。
    - 防护措施：<u>不要采用基于名称的认证</u>、<u>不要把秘密信息放在主机名中</u>、<u>采用DNSsec新标准</u>。

6. SMTP协议（<u>TCP 25</u>）：简单邮件传输协议用于发送邮件。
    - 安全问题：<u>可成为拒绝服务攻击的发源地</u>。
    - 防护措施：<u>使用SMTP认证</u>、<u>使用IMAP4协议取代</u>。

7. MIME协议：多用途网间邮件扩充协议是广泛应用的一种电子邮件技术规范。
    - 安全问题：<u>分段攻击</u>、<u>蠕虫病毒</u>。
    - 防护措施：禁用自动运行功能、拒收不完整邮件、禁止下载带有可执行文件的MIME消息。

8. POP3协议（<u>TCP 110</u>）：邮局协议是一个邮件接收协议。
    - 安全问题：<u>嗅探攻击</u>、<u>口令窃取</u>。
    - 防护措施：加装<u>防火墙</u>、对数据库进行安全加固、采用<u>SSL/TLS</u>进行数据加密。

9. IMAP4协议（<u>TCP 143,993</u>）：消息访问协议是一个邮件获取协议。
    - 安全问题：“挑战/响应”机制的<u>共享秘密信息</u>明文存储在服务器上。
    - 防护措施：使用<u>杂凑函数</u>对共享秘密进行杂凑运算。

10. PGP协议：该协议（Pretty Good Privacy）是常用的<u>安全电子邮件标准</u>。
    - 提供服务：<u>认证</u>、<u>保密</u>、<u>压缩</u>、邮件<u>兼容</u>和<u>分段</u>。
    - 安全问题：<u>公钥篡改</u>、<u>时戳不可信</u>、<u>信任模型缺陷</u>。
    - 防护措施：<u>采用数字证书</u>、<u>采用国际标准时戳协议</u>、<u>建立有效的PGP证书管理体系</u>。

11. FTP（<u>TCP 20/21</u>）：文本传输协议是Internet文件传送的基础。
    - <u>命令端口</u>即控制端口为20、<u>数据端口</u>为21。
    - 安全问题：<u>FTP 反弹攻击</u>、<u>伪装攻击</u>、<u>口令探测</u>。

12. TFTP协议（<u>UDP 69</u>）：简单文本传输协议用来在客户机和服务器之间进行简单文件传输。
    - 安全问题：仅提供简单、开销较小的不可靠的文件传输服务。

13. NFS协议（<u>UDP 2049</u>）：网络文件系统是一个基于TCP/IP网络的文件共享协议。
    - 安全问题：<u>缺乏用户认证机制</u>、<u>2049端口处于无特权范围</u>、<u>DoS攻击</u>、<u>植入攻击</u>。
    - 防护措施：<u>加强访问控制</u>、<u>防火墙禁止进程访问2049端口</u>、<u>禁止加载不可信资源</u>、<u>对外来文件进行病毒、木马查杀</u>。

14. SNMP协议（<u>UDP 161/162</u>）：简单网络管理协议用于支持网络管理系统。
    - 功能：管理节点、站、信息库和协议。
    - 安全问题：穷举攻击、重放攻击、窃听攻击。
    - 安全措施：非必要则关闭<u>SNMP代理</u>、设置复杂SNMP团体名、设置访问控制、采用<u>SNMPv3版本</u>。

15. DHCP协议（<u>UDP 67/68</u>）：动态主机配置协议用于<u>分配IP地址</u>、提供启动计算机其他信息。
    - 安全问题：<u>中间人攻击</u>、<u>DoS攻击</u>、<u>假冒攻击</u>。

16. H.323协议（<u>TCP 1720</u>）：H.323协议是用于VoIP（Voice over IP）在分组网上提供实时<u>音频</u>、<u>视频</u>和<u>数据通信</u>的标准。
    - 安全问题：<u>DoS攻击</u>、<u>注册劫持</u>、<u>会话中断</u>。

17. SIP协议（<u>TCP/UDP 5060/5061</u>）：会话启动协议是由IETF指定的基于文本编码的<u>多媒体通信协议</u>。
    - 安全问题：注册劫持、伪装攻击、消息篡改、会话终端、DoS。
    - 防护措施：网络层与传输层的安全保护、HTTP摘要认证、应用层端到端加密。

18. NTP协议（<u>UDP 123</u>）：网络时间协议可在分布式时间服务器和客户端之间进行时间同步。
    - 安全问题：<u>修改系统时间</u>使无效证书变为有效证书、<u>绕过时间戳检验</u>以实现重放攻击。
    - 防护措施：采用<u>认证技术</u>、<u>合理配置NTP守护程序</u>。

19. FINGER协议（<u>UDP 79</u>）：该协议可榜之用户查询系统中某一用户的细节（全名、住址、电话号码、登陆细节等）。
    - 安全问题：嗅探攻击、口令窃取。
    - 防护措施：使用<u>防火墙禁用此协议端口</u>。

20. WHOIS协议（<u>TCP 43</u>）：用来查询域名IP及其所有者等信息。

21. LDAP协议（<u>TCP 389</u>）：轻量级目录访问协议是基于X.500的目录访问协议，以目录形式管理资源。

22. NNTP协议（<u>TCP 119</u>）：网络新闻传输协议主要用于阅读和张贴新闻文章。
    - 安全措施：增加对相邻节点的认证，从而拒绝恶意连接请求。


